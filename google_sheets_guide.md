# 구글 스프레드시트 연동 설정 가이드

## 서비스 계정에 스프레드시트 접근 권한 부여하기

현재 발생하는 문제는 서비스 계정이 구글 스프레드시트에 접근할 수 없기 때문입니다. 아래 단계에 따라 서비스 계정에 접근 권한을 부여하세요.

### 1. 스프레드시트 공유 설정하기

1. 구글 스프레드시트(https://docs.google.com/spreadsheets/d/1C-LBiJX_ewRS-bJgY2eIKkn9dijAOPAAJuM_72izGA/edit)를 엽니다.

2. 오른쪽 상단의 "공유" 버튼을 클릭합니다.

3. "사용자 및 그룹과 공유" 필드에 다음 서비스 계정 이메일을 입력합니다:
   ```
   tutor-bot@aca-auto01.iam.gserviceaccount.com
   ```

4. 권한 설정을 "편집자"로 설정합니다.

5. (선택사항) "알림 보내기" 체크박스를 해제합니다.

6. "공유" 버튼을 클릭합니다.

### 2. 워크시트 구조 확인하기

스프레드시트에는 다음 워크시트가 필요합니다:

1. **problems** (또는 '문제'라는 단어가 포함된 워크시트):
   - 다음 열(Header)를 포함해야 합니다: 문제ID, 과목, 학년, 문제유형, 난이도, 문제내용, 정답, 해설
   - 객관식 문제인 경우: 보기1, 보기2, 보기3, 보기4, 보기5

2. **student_weaknesses** (또는 '약점'이 포함된 워크시트):
   - 다음 열을 포함해야 합니다: 학생ID, 약점 또는 weaknesses

### 3. 변경 후 확인하기

1. 앱을 다시 실행하여 구글 스프레드시트에 정상적으로 연결되는지 확인합니다.

2. "API 연결 상태"에서 "Google Sheets: 연결됨 ✅"이 표시되어야 합니다.

3. 여러 문제가 정상적으로 로드되는지 확인합니다.

## 문제 해결

오류가 계속 발생하는 경우:

1. 서비스 계정 이메일 주소가 정확히 입력되었는지 확인하세요.
2. 스프레드시트 ID가 올바른지 확인하세요: `1C-LBiJX_ewRS-bJgY2eIKkn9dijAOPAAJuM_72izGA`
3. 스프레드시트의 워크시트 이름과 열 구조가 코드에서 예상하는 구조와 일치하는지 확인하세요.
4. 앱의 콘솔 로그에서 오류 메시지를 확인하세요. 